{% extends "base_generic.html" %}
{% load crispy_forms_tags %}

{% block pagetitle %}Client Form{% endblock %}

{% block breadcrumbs %}
  <nav aria-label="breadcrumb">
    <ul class="breadcrumb">
      {% comment %} Create breadcrumbs based on the context of the request {% endcomment %}
      <li class="breadcrumb-item"><a href="{% url 'home:dashboard' %}">Dashboard</a></li>
      {% comment %} Check if `object` is in context to determine if this is a `ClientUpdate` request {% endcomment %}
      {% if object.id %}
      <li class="breadcrumb-item"><a href="{% url 'rolodex:clients' %}">Applications</a></li>
<<<<<<< HEAD
=======
      <!--Client -> Application-->
>>>>>>> 9d50a853d9165b1d8e4bf55f5d73fd33f3cd4cd7
        <li class="breadcrumb-item"><a href="{% url 'rolodex:client_detail' object.id %}">{{ client.name }}</a></li>
        <li class="breadcrumb-item active" aria-current="page">Update</li>
      {% else %}
      <li class="breadcrumb-item active" aria-current="page">New Application Form</li>
<<<<<<< HEAD
=======
      <!--Application substitute Client-->
>>>>>>> 9d50a853d9165b1d8e4bf55f5d73fd33f3cd4cd7
      {% endif %}
    </ul>
  </nav>
{% endblock %}

{% block content %}
<strong class="icon client-icon">Setup an Application</strong>
<<<<<<< HEAD
  <hr>
  <p>Use the tabs to provide basic Application information and add points of contact:</p>
=======
<!--Application substitute Client-->
  <hr>
  <p>Use the tabs to provide basic Application information and add points of contact:</p>
  <!--Application substitute Client-->
>>>>>>> 9d50a853d9165b1d8e4bf55f5d73fd33f3cd4cd7

  <!-- Form Error Section -->
  {% if form.errors %}
    <script>
      {% for field in form %}
        {% for error in field.errors %}
          displayToastTop({type: 'error', string: '{{ error }}', context: 'form'});
        {% endfor %}
      {% endfor %}
      {% for error in form.non_field_errors %}
        displayToastTop({type: 'error', string: '{{ error }}', context: 'form'});
      {% endfor %}
    </script>
  {% endif %}

  <!-- Form Section -->
  {% crispy form form.helper %}
{% endblock %}

{% block tabs %}
  {{ block.super }}
{% endblock %}

{% block tabforms %}
  {{ block.super }}
{% endblock %}

{% block morescripts %}
  <script>
    {% comment %} Formset manipulation buttons {% endcomment %}
    $('.formset-add-{{ contacts.prefix }}').click(function () {
      let form_idx = $('#id_{{ contacts.prefix }}-TOTAL_FORMS').val();
      $('#formset-{{ contacts.prefix }}').append($('#empty-form-{{ contacts.prefix }}').html().replace(/__prefix__/g, form_idx));
      $('#id_{{ contacts.prefix }}-TOTAL_FORMS').val(parseInt(form_idx) + 1);
      let new_form = $('#formset-{{ contacts.prefix }}').find('div.formset-container').last()
      new_form.find('span.counter').html(parseInt(form_idx) + 1);
      new_form.fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100);
      let target = 'id_{{ contacts.prefix }}-' + parseInt(form_idx) + '-note'
      tinymce.execCommand('mceAddEditor', false, target);
    });

<<<<<<< HEAD
=======
    // {% comment %} Roll Codename with AJAX {% endcomment %}
    // $('.js-roll-codename').click(function () {
    //   let url = $(this).attr('roll-codename-url');
    //   $.ajax({
    //     url: url,
    //     type: 'GET',
    //     success: function (data) {
    //       $('#id_codename').val(data['codename']);
    //     }
    //   });
    // });
    // removed this block to cut down the fuctionality of the dice roll button, after this will remove the button as well
>>>>>>> 9d50a853d9165b1d8e4bf55f5d73fd33f3cd4cd7
  </script>
{% endblock %}
